name: Docker CI/CD Build

on:
push:
branches:
- main

jobs:
build_and_push:
runs-on: ubuntu-latest

```
env:
  REGISTRY: ghcr.io
  IMAGE_NAME: mkldev0421/ecomers_2.0  

steps:
  - name: Checkout Repository
    uses: actions/checkout@v4

  - name: Login to GHCR
    uses: docker/login-action@v3
    with:
      registry: ${{ env.REGISTRY }}
      username: ${{ github.actor }}
      password: ${{ secrets.NEW_TOKEN }}  # Make sure this secret exists in your repo

  - name: Set up Docker Buildx
    uses: docker/setup-buildx-action@v3

  - name: Build and push Docker image
    uses: docker/build-push-action@v5
    with:
      context: ./ecom
      file: ./ecom/Dockerfile
      push: true
      tags: |
        ${{ env.REGISTRY }}/mkldev0421/ecomers_2.0:latest
        ${{ env.REGISTRY }}/mkldev0421/ecomers_2.0:sha-${{ github.sha }}
      labels: |
        org.opencontainers.image.created=${{ github.event.head_commit.timestamp }}
        org.opencontainers.image.description=Bago kasi namali yung luma
        org.opencontainers.image.source=${{ github.repositoryUrl }}
        org.opencontainers.image.version=latest
```
